spark-submit --master yarn --deploy-mode cluster --name top-words --num-executors 1 --executor-cores 1 --executor-memory 1G --driver-memory 1G --conf "spark.locality.wait=1ms" --conf spark.dynamicAllocation.enabled=false --conf "spark.yarn.executor.memoryOverhead=2048" --conf "spark.worker.cleanup.enable=true" --conf "spark.yarn.am.attemptFailuresValidityInterval=1h" --conf spark.executor.extraJavaOptions="-XX:+PrintGCDetails -XX:+PrintGCTimeStamps" --conf "spark.sql.shuffle.partitions=2" --packages org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.1 top_words.py
